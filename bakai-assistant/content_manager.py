#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º: –≤–µ–∂–ª–∏–≤–æ—Å—Ç—å, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —É—Å–ª—É–≥
"""

import re
import random
from typing import Dict, List, Optional, Set
from config import CONTENT_CONFIG

class BakaiContentManager:
    """–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º: –≤–µ–∂–ª–∏–≤–æ—Å—Ç—å, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —É—Å–ª—É–≥"""
    
    def __init__(self):
        self.forbidden_words = self._init_forbidden_words()
        self.polite_phrases = self._init_polite_phrases()
        self.service_patterns = self._init_service_patterns()
        self.service_offers = self._init_service_offers()
        self.replacements = self._init_replacements()
    
    def _init_forbidden_words(self) -> Set[str]:
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–ø–∏—Å–∫–∞ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤"""
        return {
            # –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç–µ—Ä–º–∏–Ω—ã –ò–ò
            'llm', 'language model', 'ai', 'artificial intelligence', '–º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ',
            'neural network', '–Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å', '–∞–ª–≥–æ—Ä–∏—Ç–º', '—Ç–æ–∫–µ–Ω', '–ø—Ä–æ–º–ø—Ç', 'prompt',
            'vectorstore', 'embeddings', 'chroma', 'ollama', 'langchain', 'gpt', 'chatgpt',
            '–º–æ–¥–µ–ª—å', '–Ω–µ–π—Ä–æ–Ω–∫–∞', '–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç',
            
            # –ù–µ–ø–æ–¥—Ö–æ–¥—è—â–∏–µ –¥–ª—è –±–∞–Ω–∫–∞ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
            '–Ω–µ –∑–Ω–∞—é', '–ø–æ–Ω—è—Ç–∏—è –Ω–µ –∏–º–µ—é', '–±–µ–∑ –ø–æ–Ω—è—Ç–∏—è', '—Ö—Ä–µ–Ω –∑–Ω–∞–µ—Ç', '—Ñ–∏–≥ –∑–Ω–∞–µ—Ç',
            '—á–µ—Ä—Ç –∑–Ω–∞–µ—Ç', '–Ω–µ –≤ –∫—É—Ä—Å–µ', '–Ω–∏ —Å–Ω–æ–º –Ω–∏ –¥—É—Ö–æ–º', '—Ö–∑', '–ø–æ—Ñ–∏–≥', '–ø–æ—Ñ–∏–≥—É',
            '–Ω–µ –∫—É—Ä—é', '–±–µ–∑ –ø–æ–Ω—è—Ç–∏–π', '—á—ë—Ä—Ç –∑–Ω–∞–µ—Ç', '—Ö—Ä–µ–Ω –µ–≥–æ –∑–Ω–∞–µ—Ç',
            
            # –°–ª–µ–Ω–≥ –∏ –∂–∞—Ä–≥–æ–Ω
            '–±–∞–±–∫–∏', '–¥–µ–Ω—å–∂–∞—Ç–∞', '–∫–∞–ø—É—Å—Ç–∞', '–ª–∞–≤—ç', '–∑–µ–ª–µ–Ω—å', '–±–∞–±–ª–æ', '–±–∞—à–ª–∏',
            '—Ç—ã—Å—è—á–∞', '—à—Ç—É–∫–∞', '–ª—è–º', '–∫–æ—Å–∞—Ä—å', '—Ä—É–±–∞—Å', '–±–∞–∫—Å', '–µ–≤—Ä',
            '–Ω–∞–ª', '–±–µ–∑–Ω–∞–ª', '–∫—ç—à', '–∑–∞—Ä–ø–ª–∞—Ç–∫–∞', '–ø–µ–Ω—Å–∏–æ–Ω–∫–∞',
            
            # –°–ª–∏—à–∫–æ–º –Ω–µ—Ñ–æ—Ä–º–∞–ª—å–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
            '–∫—Ä—É—Ç–æ', '–∫–ª–µ–≤–æ', '–ø—Ä–∏–∫–æ–ª—å–Ω–æ', '–æ—Ñ–∏–≥–µ—Ç—å', '–≤–∞—É', '—Å—É–ø–µ—Ä', '–º–µ–≥–∞',
            '—É–ª—å—Ç—Ä–∞', '—Ç–æ–ø', '–∫—Ä—É—Ç—è–∫', '–ø—Ä–∏–∫–æ–ª', '–∫–ª–∞—Å—Å–Ω–æ', '–æ—Ç–ø–∞–¥', '—É–ª—ë—Ç',
            '–∑–∞—á—ë—Ç', '–æ–≥–æ–Ω—å', '–±–æ–º–±–∞', '–∂–µ—Å—Ç—å', '—à–æ–∫', '–∂–µ—Å—Ç–∫–∞—á',
            
            # –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ –æ—Ç–∑—ã–≤—ã –æ –±–∞–Ω–∫–µ
            '–ø–ª–æ—Ö–æ–π –±–∞–Ω–∫', '—É–∂–∞—Å–Ω—ã–π –±–∞–Ω–∫', '–æ—Ç–≤—Ä–∞—Ç–∏—Ç–µ–ª—å–Ω—ã–π', '–∫–æ—à–º–∞—Ä –±–∞–Ω–∫',
            '—É–∂–∞—Å –±–∞–Ω–∫', '–±–µ–¥–∞ –±–∞–Ω–∫', '–ø—Ä–æ–±–ª–µ–º–Ω—ã–π –±–∞–Ω–∫', '–≥–æ–≤—ë–Ω–Ω—ã–π –±–∞–Ω–∫',
            '–¥–µ—Ä—å–º–æ–≤—ã–π –±–∞–Ω–∫', '–ø–∞—Ä—à–∏–≤—ã–π –±–∞–Ω–∫'
        }
    
    def _init_polite_phrases(self) -> Dict[str, List[str]]:
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ–∂–ª–∏–≤—ã—Ö —Ñ—Ä–∞–∑"""
        return {
            'greetings': [
                "–ë–ª–∞–≥–æ–¥–∞—Ä—é –∑–∞ –æ–±—Ä–∞—â–µ–Ω–∏–µ –≤ –±–∞–Ω–∫ –ë–∞–∫–∞–π! ",
                "–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –≤–æ–ø—Ä–æ—Å! ",
                "–†–∞–¥ –ø–æ–º–æ—á—å –≤–∞–º! ",
                "–° —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ–º –æ—Ç–≤–µ—á—É –Ω–∞ –≤–∞—à –≤–æ–ø—Ä–æ—Å! ",
                "–ë–ª–∞–≥–æ–¥–∞—Ä—é –∑–∞ –¥–æ–≤–µ—Ä–∏–µ –∫ –±–∞–Ω–∫—É –ë–∞–∫–∞–π! ",
                "–°–ø–∞—Å–∏–±–æ, —á—Ç–æ –≤—ã–±—Ä–∞–ª–∏ –Ω–∞—à –±–∞–Ω–∫! ",
                "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é! –†–∞–¥ –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω—ã–º! ",
                "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å! "
            ],
            'endings': [
                " –ë—É–¥–µ–º —Ä–∞–¥—ã –ø–æ–º–æ—á—å –≤–∞–º –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è!",
                " –û–±—Ä–∞—â–∞–π—Ç–µ—Å—å, –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤—ã –ø–æ–º–æ—á—å!",
                " –°–ø–∞—Å–∏–±–æ –∑–∞ –≤—ã–±–æ—Ä –±–∞–Ω–∫–∞ –ë–∞–∫–∞–π!",
                " –†–∞–¥—ã –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω—ã–º–∏!",
                " –° —É–≤–∞–∂–µ–Ω–∏–µ–º, –∫–æ–º–∞–Ω–¥–∞ –±–∞–Ω–∫–∞ –ë–∞–∫–∞–π!",
                " –£–¥–∞—á–Ω–æ–≥–æ –¥–Ω—è –∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –±–ª–∞–≥–æ–ø–æ–ª—É—á–∏—è!",
                " –ñ–µ–ª–∞–µ–º —É—Å–ø–µ—Ö–æ–≤ –≤ –≤–∞—à–∏—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–µ–ª–∞—Ö!",
                " –í–∞—à–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–µ –±–ª–∞–≥–æ–ø–æ–ª—É—á–∏–µ - –Ω–∞—à–∞ —Ü–µ–ª—å!"
            ]
        }
    
    def _init_service_patterns(self) -> Dict[str, List[str]]:
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–æ–≤ —É—Å–ª—É–≥"""
        return {
            'cards': [
                '–∫–∞—Ä—Ç–∞', '–∫–∞—Ä—Ç—É', '–∫–∞—Ä—Ç—ã', '–∫–∞—Ä—Ç–æ–π', '–∫–∞—Ä—Ç–µ', '–±–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞',
                'visa', 'mastercard', '—ç–ª–∫–∞—Ä—Ç', 'elkart', '–ø–ª–∞—Ç–µ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞',
                '–¥–µ–±–µ—Ç–æ–≤–∞—è', '–∫—Ä–µ–¥–∏—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞', '—Å—Ç–∏–∫–µ—Ä', '–ø–ª–∞—Ç–µ–∂–Ω—ã–π —Å—Ç–∏–∫–µ—Ä',
                'nfc', '–±–µ—Å–∫–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è', '–∫–µ—à–±—ç–∫', 'cashback', '—Ç—É–º–∞—Ä', '—Ä–∞—Å—Å—Ä–æ—á–∫–∞',
                '–æ—Ç–∫—Ä—ã—Ç—å –∫–∞—Ä—Ç—É', '–æ—Ñ–æ—Ä–º–∏—Ç—å –∫–∞—Ä—Ç—É', '–∑–∞–∫–∞–∑–∞—Ç—å –∫–∞—Ä—Ç—É', '–ø–æ–ª—É—á–∏—Ç—å –∫–∞—Ä—Ç—É',
                '–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ä—Ç—É', '–ø–∏–Ω –∫–æ–¥', '–ø–∏–Ω-–∫–æ–¥', 'cvv', 'cvc'
            ],
            'credits': [
                '–∫—Ä–µ–¥–∏—Ç', '–∫—Ä–µ–¥–∏—Ç–∞', '–∫—Ä–µ–¥–∏—Ç–µ', '–∫—Ä–µ–¥–∏—Ç—ã', '–∫—Ä–µ–¥–∏—Ç–Ω—ã–π', '–∑–∞–π–º',
                '–∏–ø–æ—Ç–µ–∫–∞', '–∞–≤—Ç–æ–∫—Ä–µ–¥–∏—Ç', '–ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–∏–π –∫—Ä–µ–¥–∏—Ç', '–∫—Ä–µ–¥–∏—Ç–æ–≤–∞–Ω–∏–µ',
                '–∑–∞–µ–º', '—Å—Å—É–¥–∞', '–∫—Ä–µ–¥–∏—Ç–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç', '–≤–∑—è—Ç—å –∫—Ä–µ–¥–∏—Ç', '–ø–æ–ª—É—á–∏—Ç—å –∫—Ä–µ–¥–∏—Ç',
                '–æ—Ñ–æ—Ä–º–∏—Ç—å –∫—Ä–µ–¥–∏—Ç', '—Å—Ç–∞–≤–∫–∞ –∫—Ä–µ–¥–∏—Ç', '—É—Å–ª–æ–≤–∏—è –∫—Ä–µ–¥–∏—Ç', '–∫—Ä–µ–¥–∏—Ç–Ω–∞—è –ª–∏–Ω–∏—è',
                '—Ä–µ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ', '—Ä–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è', '–¥–æ—Å—Ä–æ—á–Ω–æ–µ –ø–æ–≥–∞—à–µ–Ω–∏–µ'
            ],
            'deposits': [
                '–¥–µ–ø–æ–∑–∏—Ç', '–¥–µ–ø–æ–∑–∏—Ç–∞', '–¥–µ–ø–æ–∑–∏—Ç–µ', '–¥–µ–ø–æ–∑–∏—Ç—ã', '–¥–µ–ø–æ–∑–∏—Ç–Ω—ã–π',
                '–≤–∫–ª–∞–¥', '–≤–∫–ª–∞–¥–∞', '–≤–∫–ª–∞–¥–µ', '–≤–∫–ª–∞–¥—ã', '–Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–π', '—Å–±–µ—Ä–µ–≥–∞—Ç–µ–ª—å–Ω—ã–π',
                '—Å—Ä–æ—á–Ω—ã–π –≤–∫–ª–∞–¥', '–æ—Ç–∫—Ä—ã—Ç—å –¥–µ–ø–æ–∑–∏—Ç', '–æ—Ñ–æ—Ä–º–∏—Ç—å –≤–∫–ª–∞–¥', '–ø—Ä–æ—Ü–µ–Ω—Ç –¥–µ–ø–æ–∑–∏—Ç',
                '–∫–∞–ø–∏—Ç–∞–ª–∏–∑–∞—Ü–∏—è', '–ø–æ–ø–æ–ª–Ω–∏—Ç—å –¥–µ–ø–æ–∑–∏—Ç', '–ø—Ä–æ—Ü–µ–Ω—Ç—ã –≤–∫–ª–∞–¥', '—Å–±–µ—Ä–µ–≥–∞—Ç–µ–ª—å–Ω—ã–π —Å—á–µ—Ç'
            ],
            'business': [
                '—Ä–∞—Å—á–µ—Ç–Ω—ã–π —Å—á–µ—Ç', '—Ä–∞—Å—á—ë—Ç–Ω—ã–π —Å—á—ë—Ç', '—Ä/—Å', '—Ä—Å', '—Ä–∞—Å—á–µ—Ç–∫–∞',
                '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π', '–±–∏–∑–Ω–µ—Å', '—é—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ', '—é—Ä–ª–∏—Ü–æ', '–∏–ø',
                '–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å', '–ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å', '—Å—á–µ—Ç –¥–ª—è –±–∏–∑–Ω–µ—Å–∞',
                '–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞', '—ç–∫–≤–∞–π—Ä–∏–Ω–≥', 'pos —Ç–µ—Ä–º–∏–Ω–∞–ª', '–∏–Ω–∫–∞—Å—Å–∞—Ü–∏—è',
                '–¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç', '–±–∞–Ω–∫-–∫–ª–∏–µ–Ω—Ç', '–∑–∞—Ä–ø–ª–∞—Ç–Ω—ã–π –ø—Ä–æ–µ–∫—Ç'
            ],
            'insurance': [
                '—Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ', '—Å—Ç—Ä–∞—Ö–æ–≤–∫–∞', '—Å—Ç—Ä–∞—Ö–æ–≤–æ–π', '–ø–æ–ª–∏—Å', '—Å—Ç—Ä–∞—Ö–æ–≤–æ–π –ø—Ä–æ–¥—É–∫—Ç',
                '–∑–∞—Å—Ç—Ä–∞—Ö–æ–≤–∞—Ç—å', '—Å—Ç—Ä–∞—Ö–æ–≤–∞—è –∑–∞—â–∏—Ç–∞', '—Å—Ç—Ä–∞—Ö–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ', '–æ—Å–∞–≥–æ',
                '–∫–∞—Å–∫–æ', '—Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –∂–∏–∑–Ω–∏', '–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞'
            ],
            'transfers': [
                '–ø–µ—Ä–µ–≤–æ–¥', '–ø–µ—Ä–µ–≤–æ–¥—ã', '–¥–µ–Ω–µ–∂–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥', '–æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–µ–Ω—å–≥–∏',
                '–ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ', '–ø–ª–∞—Ç–µ–∂', '–æ–ø–ª–∞—Ç–∞', '–ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –¥–µ–Ω—å–≥–∏', '–ø–ª–∞—Ç–µ–∂–∏',
                '–±—ã—Å—Ç—Ä—ã–π –ø–µ—Ä–µ–≤–æ–¥', '–º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥', '–≤–∞–ª—é—Ç–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥'
            ],
            'exchange': [
                '–æ–±–º–µ–Ω –≤–∞–ª—é—Ç', '–≤–∞–ª—é—Ç–∞', '–∫—É—Ä—Å', '–¥–æ–ª–ª–∞—Ä', '–µ–≤—Ä–æ', '–∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è',
                '–≤–∞–ª—é—Ç–Ω—ã–π', '–æ–±–º–µ–Ω–∫–∞', '–∫—É—Ä—Å –≤–∞–ª—é—Ç', '–æ–±–º–µ–Ω—è—Ç—å –≤–∞–ª—é—Ç—É', '–ø–æ–∫—É–ø–∫–∞ –≤–∞–ª—é—Ç—ã',
                '–ø—Ä–æ–¥–∞–∂–∞ –≤–∞–ª—é—Ç—ã', '–≤–∞–ª—é—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏'
            ]
        }
    
    def _init_service_offers(self) -> Dict[str, List[str]]:
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π —É—Å–ª—É–≥"""
        return {
            'cards': [
                "–•–æ—Ç–∏—Ç–µ, –ø–æ–º–æ–≥—É –æ—Ñ–æ—Ä–º–∏—Ç—å –±–∞–Ω–∫–æ–≤—Å–∫—É—é –∫–∞—Ä—Ç—É? –≠—Ç–æ –∑–∞–π–º–µ—Ç –≤—Å–µ–≥–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç!",
                "–ú–æ–≥—É –ø–æ–º–æ—á—å —Å –∑–∞–∫–∞–∑–æ–º –∫–∞—Ä—Ç—ã. –ñ–µ–ª–∞–µ—Ç–µ —É–∑–Ω–∞—Ç—å –æ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞—Ö?",
                "–ü—Ä–µ–¥–ª–∞–≥–∞—é –æ—Ñ–æ—Ä–º–∏—Ç—å –∫–∞—Ä—Ç—É –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å. –ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ, –∫–∞–∫–∞—è –≤–∞–º –ø–æ–¥–æ–π–¥–µ—Ç?",
                "–•–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã —è –ø–æ–º–æ–≥ –≤—ã–±—Ä–∞—Ç—å –∏ –æ—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥—Ö–æ–¥—è—â—É—é –∫–∞—Ä—Ç—É?",
                "–ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å —Å –≤—ã–±–æ—Ä–æ–º –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –∫–∞—Ä—Ç—ã –¥–ª—è –≤–∞—à–∏—Ö –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π!"
            ],
            'credits': [
                "–•–æ—Ç–∏—Ç–µ, –ø–æ–º–æ–≥—É –æ—Ñ–æ—Ä–º–∏—Ç—å –∫—Ä–µ–¥–∏—Ç? –ú–æ–≥—É —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å —É—Å–ª–æ–≤–∏—è –ø–æ–¥ –≤–∞—à–∏ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏!",
                "–ú–æ–≥—É –ø–æ–º–æ—á—å —Å –ø–æ–ª—É—á–µ–Ω–∏–µ–º –∫—Ä–µ–¥–∏—Ç–∞. –ñ–µ–ª–∞–µ—Ç–µ —É–∑–Ω–∞—Ç—å –æ –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã—Ö —Å—Ç–∞–≤–∫–∞—Ö?",
                "–ü—Ä–µ–¥–ª–∞–≥–∞—é —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞—à–∏ –∫—Ä–µ–¥–∏—Ç–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã. –ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ?",
                "–•–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã —è –ø–æ–º–æ–≥ –ø–æ–¥–æ–±—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –∫—Ä–µ–¥–∏—Ç–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç?",
                "–ì–æ—Ç–æ–≤ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –∫—Ä–µ–¥–∏—Ç–æ–≤–∞–Ω–∏—è!"
            ],
            'deposits': [
                "–•–æ—Ç–∏—Ç–µ, –ø–æ–º–æ–≥—É –æ—Ç–∫—Ä—ã—Ç—å –¥–µ–ø–æ–∑–∏—Ç? –ú–æ–≥—É –ø–æ–¥–æ–±—Ä–∞—Ç—å –≤—ã–≥–æ–¥–Ω—ã–µ —É—Å–ª–æ–≤–∏—è!",
                "–ú–æ–≥—É –ø–æ–º–æ—á—å —Å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ–º –≤–∫–ª–∞–¥–∞. –ñ–µ–ª–∞–µ—Ç–µ —É–∑–Ω–∞—Ç—å –æ –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã—Ö —Å—Ç–∞–≤–∫–∞—Ö?",
                "–ü—Ä–µ–¥–ª–∞–≥–∞—é –æ—Ç–∫—Ä—ã—Ç—å –¥–µ–ø–æ–∑–∏—Ç –¥–ª—è –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è —Å—Ä–µ–¥—Å—Ç–≤. –ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ?",
                "–•–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã —è –ø–æ–º–æ–≥ –≤—ã–±—Ä–∞—Ç—å –ø–æ–¥—Ö–æ–¥—è—â–∏–π –¥–µ–ø–æ–∑–∏—Ç–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç?",
                "–ì–æ—Ç–æ–≤ –ø–æ–¥–æ–±—Ä–∞—Ç—å –¥–µ–ø–æ–∑–∏—Ç —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å—é!"
            ],
            'business': [
                "–•–æ—Ç–∏—Ç–µ, –ø–æ–º–æ–≥—É –æ—Ç–∫—Ä—ã—Ç—å —Ä–∞—Å—á–µ—Ç–Ω—ã–π —Å—á—ë—Ç? –≠—Ç–æ –∑–∞–π–º–µ—Ç –≤—Å–µ–≥–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç!",
                "–ú–æ–≥—É –ø–æ–º–æ—á—å —Å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ–º –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ —Å—á–µ—Ç–∞. –ñ–µ–ª–∞–µ—Ç–µ —É–∑–Ω–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏?",
                "–ü—Ä–µ–¥–ª–∞–≥–∞—é –æ—Ñ–æ—Ä–º–∏—Ç—å —Ä–∞—Å—á–µ—Ç–Ω—ã–π —Å—á—ë—Ç –¥–ª—è –≤–∞—à–µ–≥–æ –±–∏–∑–Ω–µ—Å–∞. –ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ?",
                "–•–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã —è –ø–æ–º–æ–≥ —Å –æ—Ç–∫—Ä—ã—Ç–∏–µ–º —Å—á–µ—Ç–∞ –¥–ª—è –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏?",
                "–ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å —Å –ø–æ–ª–Ω—ã–º –±–∞–Ω–∫–æ–≤—Å–∫–∏–º –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ–º –≤–∞—à–µ–≥–æ –±–∏–∑–Ω–µ—Å–∞!"
            ],
            'insurance': [
                "–•–æ—Ç–∏—Ç–µ, –ø–æ–º–æ–≥—É –æ—Ñ–æ—Ä–º–∏—Ç—å —Å—Ç—Ä–∞—Ö–æ–≤–∫—É? –ú–æ–≥—É –ø–æ–¥–æ–±—Ä–∞—Ç—å –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø–æ–ª–∏—Å!",
                "–ú–æ–≥—É –ø–æ–º–æ—á—å —Å –≤—ã–±–æ—Ä–æ–º —Å—Ç—Ä–∞—Ö–æ–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞. –ñ–µ–ª–∞–µ—Ç–µ —É–∑–Ω–∞—Ç—å —É—Å–ª–æ–≤–∏—è?",
                "–ü—Ä–µ–¥–ª–∞–≥–∞—é —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞—à–∏ —Å—Ç—Ä–∞—Ö–æ–≤—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã. –ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ?",
                "–•–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã —è –ø–æ–º–æ–≥ –ø–æ–¥–æ–±—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—É—é —Å—Ç—Ä–∞—Ö–æ–≤—É—é –∑–∞—â–∏—Ç—É?",
                "–ì–æ—Ç–æ–≤ –ø–æ–¥–æ–±—Ä–∞—Ç—å —Å—Ç—Ä–∞—Ö–æ–≤–∫—É, –∫–æ—Ç–æ—Ä–∞—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –∑–∞—â–∏—Ç–∏—Ç –≤–∞—à–∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã!"
            ],
            'transfers': [
                "–•–æ—Ç–∏—Ç–µ, –ø–æ–º–æ–≥—É –æ—Ñ–æ—Ä–º–∏—Ç—å –¥–µ–Ω–µ–∂–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥? –ú–æ–≥—É –ø–æ–¥—Å–∫–∞–∑–∞—Ç—å –≤—ã–≥–æ–¥–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã!",
                "–ú–æ–≥—É –ø–æ–º–æ—á—å —Å –ø–µ—Ä–µ–≤–æ–¥–æ–º —Å—Ä–µ–¥—Å—Ç–≤. –ñ–µ–ª–∞–µ—Ç–µ —É–∑–Ω–∞—Ç—å –æ –∫–æ–º–∏—Å—Å–∏—è—Ö?",
                "–ü—Ä–µ–¥–ª–∞–≥–∞—é –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –Ω–∞—à–∏–º–∏ —É—Å–ª—É–≥–∞–º–∏ –¥–µ–Ω–µ–∂–Ω—ã—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤. –ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ?",
                "–•–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã —è –ø–æ–º–æ–≥ —Å –±—ã—Å—Ç—Ä—ã–º –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–º –ø–µ—Ä–µ–≤–æ–¥–æ–º?",
                "–ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å —Å –ø–µ—Ä–µ–≤–æ–¥–æ–º –ø–æ —Å–∞–º—ã–º –≤—ã–≥–æ–¥–Ω—ã–º —Ç–∞—Ä–∏—Ñ–∞–º!"
            ],
            'exchange': [
                "–•–æ—Ç–∏—Ç–µ, –ø–æ–º–æ–≥—É —Å –æ–±–º–µ–Ω–æ–º –≤–∞–ª—é—Ç? –ú–æ–≥—É –ø–æ–¥—Å–∫–∞–∑–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–π –∫—É—Ä—Å!",
                "–ú–æ–≥—É –ø–æ–º–æ—á—å —Å –≤–∞–ª—é—Ç–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏. –ñ–µ–ª–∞–µ—Ç–µ —É–∑–Ω–∞—Ç—å —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–µ –∫—É—Ä—Å—ã?",
                "–ü—Ä–µ–¥–ª–∞–≥–∞—é –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤—ã–≥–æ–¥–Ω—ã–º –æ–±–º–µ–Ω–æ–º –≤–∞–ª—é—Ç. –ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ?",
                "–•–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã —è –ø–æ–º–æ–≥ —Å –≤–∞–ª—é—Ç–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏ –ø–æ –ª—É—á—à–µ–º—É –∫—É—Ä—Å—É?",
                "–ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å —Å –æ–±–º–µ–Ω–æ–º –≤–∞–ª—é—Ç –ø–æ —Å–∞–º–æ–º—É –≤—ã–≥–æ–¥–Ω–æ–º—É –∫—É—Ä—Å—É!"
            ]
        }
    
    def _init_replacements(self) -> Dict[str, str]:
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–º–µ–Ω –¥–ª—è –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤"""
        return {
            '–Ω–µ –∑–Ω–∞—é': '—É—Ç–æ—á–Ω—é –¥–ª—è –≤–∞—Å',
            '–ø–æ–Ω—è—Ç–∏—è –Ω–µ –∏–º–µ—é': '—Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —É—Ç–æ—á–Ω–µ–Ω–∏—è',
            '—Ö–∑': '—É—Ç–æ—á–Ω–∏–º',
            '–ø–æ—Ñ–∏–≥': '–Ω–µ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è',
            '–±–∞–±–∫–∏': '–¥–µ–Ω–µ–∂–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞',
            '–ª–∞–≤—ç': '–¥–µ–Ω–µ–∂–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞',
            '–¥–µ–Ω—å–∂–∞—Ç–∞': '–¥–µ–Ω–µ–∂–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞',
            '–∫—Ä—É—Ç–æ': '–æ—Ç–ª–∏—á–Ω–æ',
            '–∫–ª–µ–≤–æ': '—Ö–æ—Ä–æ—à–æ',
            '—Å—É–ø–µ—Ä': '–ø—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ',
            # –£–±–∏—Ä–∞–µ–º –∑–∞–º–µ–Ω—É AI - –ø—É—Å—Ç—å –æ—Å—Ç–∞–µ—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å –≤ –Ω–∞–∑–≤–∞–Ω–∏—è—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
            # 'ai': '–Ω–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞',
            'llm': '—Å–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏',
            '–∞–ª–≥–æ—Ä–∏—Ç–º': '–Ω–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞',
            '–º–æ–¥–µ–ª—å': '—Å–∏—Å—Ç–µ–º–∞',
            '—à—Ç—É–∫–∞': '–µ–¥–∏–Ω–∏—Ü–∞',
            '—Ç—ã—Å—è—á–∞': '—Ç—ã—Å—è—á–∞ —Ä—É–±–ª–µ–π'
        }
    
    def filter_content(self, text: str) -> str:
        """–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∑–∞–ø—Ä–µ—â–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞"""
        if not CONTENT_CONFIG.get("enable_filtering", True):
            return text
        
        text_lower = text.lower()
        
        for forbidden in self.forbidden_words:
            if forbidden in text_lower:
                replacement = self.replacements.get(forbidden, '–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è')
                # –ó–∞–º–µ–Ω—è–µ–º —Å —É—á–µ—Ç–æ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞
                text = re.sub(re.escape(forbidden), replacement, text, flags=re.IGNORECASE)
                print(f"üö´ –ó–∞–º–µ–Ω–µ–Ω–æ: '{forbidden}' ‚Üí '{replacement}'")
        
        return text
    
    def add_politeness(self, text: str) -> str:
        """–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–µ–∂–ª–∏–≤—ã—Ö —Ñ—Ä–∞–∑"""
        if not CONTENT_CONFIG.get("enable_politeness", True):
            return text
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ –≤–µ–∂–ª–∏–≤—ã–µ —Ñ—Ä–∞–∑—ã
        text_lower = text.lower()
        
        has_greeting = any(phrase.strip().lower() in text_lower 
                          for phrase in self.polite_phrases['greetings'])
        
        has_ending = any(phrase.strip().lower() in text_lower 
                        for phrase in self.polite_phrases['endings'])
        
        # –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
        if not has_greeting:
            greeting = random.choice(self.polite_phrases['greetings'])
            text = greeting + text
        
        # –î–æ–±–∞–≤–ª—è–µ–º –æ–∫–æ–Ω—á–∞–Ω–∏–µ
        if not has_ending:
            if not text.endswith(('.', '!', '?')):
                text += '.'
            ending = random.choice(self.polite_phrases['endings'])
            text += ending
        
        return text
    
    def detect_service_type(self, query: str) -> Optional[str]:
        """–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –±–∞–Ω–∫–æ–≤—Å–∫–æ–π —É—Å–ª—É–≥–∏ –ø–æ –∑–∞–ø—Ä–æ—Å—É"""
        query_lower = query.lower()
        service_scores = {}
        
        for service_type, patterns in self.service_patterns.items():
            score = 0
            for pattern in patterns:
                if pattern in query_lower:
                    # –î–ª–∏–Ω–Ω—ã–µ —Ñ—Ä–∞–∑—ã –ø–æ–ª—É—á–∞—é—Ç –±–æ–ª—å—à–µ –±–∞–ª–ª–æ–≤
                    score += len(pattern.split()) * 2 + 1
            
            if score > 0:
                service_scores[service_type] = score
        
        if service_scores:
            best_service = max(service_scores, key=service_scores.get)
            print(f"üéØ –û–ø—Ä–µ–¥–µ–ª–µ–Ω —Ç–∏–ø —É—Å–ª—É–≥–∏: {best_service} (–±–∞–ª–ª: {service_scores[best_service]})")
            return best_service
        
        return None
    
    def get_service_offer(self, service_type: str) -> Optional[str]:
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —É—Å–ª—É–≥–∏"""
        offers = self.service_offers.get(service_type, [])
        return random.choice(offers) if offers else None
    
    def enhance_response(self, text: str, query: str) -> str:
        """–ü–æ–ª–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞: —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è + –≤–µ–∂–ª–∏–≤–æ—Å—Ç—å + –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è"""
        # 1. –§–∏–ª—å—Ç—Ä—É–µ–º –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
        text = self.filter_content(text)
        
        # 2. –î–æ–±–∞–≤–ª—è–µ–º –≤–µ–∂–ª–∏–≤–æ—Å—Ç—å
        text = self.add_politeness(text)
        
        # 3. –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø —É—Å–ª—É–≥–∏ –∏ –¥–æ–±–∞–≤–ª—è–µ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ
        if CONTENT_CONFIG.get("enable_offers", True):
            service_type = self.detect_service_type(query)
            if service_type:
                offer = self.get_service_offer(service_type)
                if offer:
                    if not text.endswith(('.', '!', '?')):
                        text += '.'
                    text += f"\n\nüí° {offer}"
        
        return text
    
    def validate_response_length(self, text: str) -> bool:
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã –æ—Ç–≤–µ—Ç–∞"""
        min_length = CONTENT_CONFIG.get("min_answer_length", 10)
        return len(text.strip()) >= min_length
    
    def get_service_statistics(self, queries: List[str]) -> Dict[str, int]:
        """–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —É—Å–ª—É–≥ –¥–ª—è —Å–ø–∏—Å–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤"""
        stats = {}
        for query in queries:
            service_type = self.detect_service_type(query)
            if service_type:
                stats[service_type] = stats.get(service_type, 0) + 1
        return stats